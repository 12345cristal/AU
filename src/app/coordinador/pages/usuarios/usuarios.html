<div class="container">
  <!-- Buscador y filtros -->
  <div class="buscador-filtros">
    <input 
      type="text" 
      placeholder="Buscar usuario" 
      [value]="searchQuery()" 
      (input)="actualizarBusqueda($event.target.value)" 
    />
    <button (click)="cambiarFiltro(true)" [class.active]="mostrarActivos()">Activos</button>
    <button (click)="cambiarFiltro(false)" [class.active]="!mostrarActivos()">Inactivos</button>
    <button (click)="agregarUsuario()">+ Nuevo Usuario</button>
  </div>

  <!-- Cargando -->
  <div [hidden]="!cargando()">Cargando usuarios...</div>

  <!-- Lista de usuarios -->
  <ng-container>
    <div *ngFor="let u of filteredUsuarios()">
      <div class="usuario-item">
        <div class="info">
          <span class="nombre">{{ u.nombre }}</span>
          <span class="rol">{{ u.rol }}</span>
          <span class="contacto">{{ u.contacto }}</span>
          <span class="ultimo-acceso">{{ u.ultimoAcceso }}</span>
        </div>
        <div class="acciones">
          <button (click)="editarUsuario(u)">Editar</button>
          <button (click)="permisosUsuario(u)">Permisos</button>
          <button (click)="toggleActivo(u)">{{ u.activo ? 'Desactivar' : 'Activar' }}</button>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Modal Editar -->
  <div [hidden]="!mostrarModalEditar()">
    <div class="modal-content">
      <h3>Editar Usuario</h3>
      <input [(ngModel)]="usuarioSeleccionado().nombre" placeholder="Nombre">
      <input [(ngModel)]="usuarioSeleccionado().rol" placeholder="Rol">
      <input [(ngModel)]="usuarioSeleccionado().contacto" placeholder="Contacto">
      <input [(ngModel)]="usuarioSeleccionado().especialidad" placeholder="Especialidad">
      <button (click)="guardarEdicion()">Guardar</button>
      <button (click)="mostrarModalEditar.set(false)">Cancelar</button>
    </div>
  </div>

  <!-- Modal Permisos -->
  <div [hidden]="!mostrarModalPermisos()">
    <div class="modal-content">
      <h3>Permisos de {{ usuarioSeleccionado()?.nombre }}</h3>
      <button (click)="mostrarModalPermisos.set(false)">Cerrar</button>
    </div>
  </div>

  <!-- Modal Nuevo -->
  <div [hidden]="!mostrarModalNuevo()">
    <div class="modal-content">
      <h3>Nuevo Usuario</h3>
      <input [(ngModel)]="usuarioSeleccionado().nombre" placeholder="Nombre">
      <input [(ngModel)]="usuarioSeleccionado().rol" placeholder="Rol">
      <input [(ngModel)]="usuarioSeleccionado().contacto" placeholder="Contacto">
      <input [(ngModel)]="usuarioSeleccionado().especialidad" placeholder="Especialidad">
      <button (click)="guardarNuevoUsuario()">Guardar</button>
      <button (click)="mostrarModalNuevo.set(false)">Cancelar</button>
    </div>
  </div>
</div>
